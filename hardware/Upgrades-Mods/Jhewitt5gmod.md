# Rev3 5G Mod

### Table of Contents
1. [Overview](#overview)
2. [Requirements](#1-requirements)
3. [Connecting the BW16](#2-preparing-the-bw16)
4. [Configuration](#3-configuration)
5. [Verifying Connection](#4-verifying-connection)
6. [Troubleshooting](#5-troubleshooting)
7. [Build Modifications](#6-build-modifications)

### Overview
Adds 5GHz scanning to the wardriver.uk. **A modified case or slim build is needed to ensure space for the extra board.** 

The [Build Modifications](#6-build-modifications) section at the bottom of the page has 3D-printable cases that will fit without modification.  

*As described by the creator of this project, Joseph Hewitt:*
> [!NOTE]  
>"The RX/TX of the BW16 should match the SIM800L RX/TX (but don't also connect the SIM800). I'm using the default BW16 AT firmware for now, so don't flash it.
Update A and B from the git main branch, then read the last entry here: wardriver.uk/advanced_config"

## 1. Requirements
- BW16 module with v1.1 AT firmware
- [Wardriver.uk](wardriver.uk) rev3 w/o SIM800L
- UFL adapter for the antenna

## 2. Preparing the BW16

> [!WARNING] 
> Either the SIM800L or BW16 can be used. **Do not attach both**. This mod  sacrifices GSM towers for 5G WiFi networks.

### UFL
- Solder the UFL to the pads on the corner of the MCU. Heat one pad, then quickly move the UFL into position. This must be done with some care and accuracy, but is just surface soldering. 

### Resistor/Solder Bridge
- To use the external antenna remove the 0ohm resistor shown in red. Reuse the resistor or solder bridge on the green.

![image](https://github.com/Root-Down-Digital/pentesting-resources/assets/10099969/cae9f924-3cbe-4d57-a12c-3ac39fefaa04)

*Image credit: @CoD_Segfault

![image](https://github.com/Root-Down-Digital/pentesting-resources/assets/10099969/a9ad8fc1-6436-4c54-ab06-f8a3666be4cd)

- Test the antenna using an Arduino sketch to validate. Test polarity and continuity manually.

### Wiring 

- Connect RX/TX of the BW16 to the corresponding RX/TX on the board for the SIM800L.
- Connect the GND and VCC of the BW16 to the same row:

| SIM800L PCB Pin | BW16 Connection |
|-----------|-----------------|
| 5V        | VCC             |
| Pin 2     | Not Used        |
| RX        | RX              |
| TX        | TX              |
| GND       | GND             |

![image](https://github.com/Root-Down-Digital/pentesting-resources/assets/10099969/480fe41f-413c-4852-8a7b-0668ba2d89ad)


## 3. Configuration 

- **Create a plain text file named `cfg.txt`in the root folder of the SD card.** *This is the [advanced config file](wardriver.uk/advanced_config) and has several features.*

- **Add the line: `sb_bw16=yes` and save the file.** 

## 4. Verifying Connection

- Unit should display rev3 5g (mod) when initializing.  

- Once running, an additional number for 5G nets is added next to the 2G count:  `WiFi:25|20`

## 5. Troubleshooting

> [!IMPORTANT]  
> "There was a breaking change to the upstream ESP32 board library recently. Make sure you are using 2.0.12 because the 3.x branch isn't compatible yet" - Joseph Hewitt

## 6. Build Modifications 

> [!TIP]  
> Angle the "A" board, allowing enough room for a USB cable. Test while assembling:
![image](https://github.com/Root-Down-Digital/pentesting-resources/assets/10099969/afbbf3d7-7c75-4740-a3e8-68f7ed1c509a)

> [!TIP]
> Solder the SD without the headers, insulate with tape for a few mm of space where the BW16 board (pins removed) will sit.
>   ![image](https://github.com/Root-Down-Digital/pentesting-resources/assets/10099969/1022a50c-d0bb-491f-a843-15096d13b7ed)

- Cut pins flush on the back of the board for a better fit in the micro case linked below. 


### 5G Mod Cases

You can find cases made by others, modified to accommodate the three bulkheads [here](https://github.com/lukeswitz/3D-Prints/tree/main/Hewitt-Wardriver). Files with `5gFit` prefix fit well without build modifications. 

> [!TIP]
> Slide in the SMA bulkheads first.  Twist to ensure the UFLs will lay as flat as possible to the board. Then, angling the board down under the pigtails, carefully slide and seat it. 
