# `grep Cheatsheet`

## Basic Usage

| Description                                      | Command                               |
|--------------------------------------------------|---------------------------------------|
| Search for a Specific Pattern in a File          | `grep pattern file.txt`               |
| Search for a Specific Pattern in Multiple Files  | `grep pattern file1.txt file2.txt`    |
| Case-Insensitive Search                          | `grep -i pattern file.txt`            |
| Display Line Numbers with Matches                | `grep -n pattern file.txt`            |
| Search for a Pattern Recursively in Directories  | `grep -r pattern /path/to/directory`  |

## Output Control

| Description                                      | Command                               |
|--------------------------------------------------|---------------------------------------|
| Display Only Matching Parts of Lines             | `grep -o pattern file.txt`            |
| Count the Number of Matching Lines               | `grep -c pattern file.txt`            |
| Invert Match to Display Non-Matching Lines       | `grep -v pattern file.txt`            |
| Display File Names with Matches                  | `grep -l pattern /path/to/directory/*`|
| Display File Names without Matches               | `grep -L pattern /path/to/directory/*`|

## Advanced Search

| Description                                      | Command                               |
|--------------------------------------------------|---------------------------------------|
| Search for a Regular Expression                  | `grep -E regex file.txt`              |
| Search for Fixed Strings (No Regular Expressions)| `grep -F fixed string file.txt`       |
| Highlight Matches in the Output                  | `grep --color=auto pattern file.txt`  |
| Display the Count of Matches in Each File        | `grep -c pattern /path/to/directory/*`|

## Context Matching

| Description                                      | Command                               |
|--------------------------------------------------|---------------------------------------|
| Display Lines Matching a Pattern and Their Context | `grep -C 3 pattern file.txt` <br> # 3 lines of context |
| Display Lines Matching a Pattern and Preceding Context | `grep -B 3 pattern file.txt` <br> # 3 lines before match |
| Display Lines Matching a Pattern and Following Context | `grep -A 3 pattern file.txt` <br> # 3 lines after match |

## Additional Commands for Red & Blue Teams

| Description                                      | Command                                                     |
|--------------------------------------------------|-------------------------------------------------------------|
| Search for IP Addresses                          | `grep -Eo '([0-9]{1,3}\.){3}[0-9]{1,3}' file.txt`           |
| Search for URLs                                  | `grep -Eo 'http[s]?://[^ ]+' file.txt`                      |
| Extract Email Addresses                          | `grep -Eo '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}\b' file.txt` |
| Search for HTTP Status Codes                     | `grep -Eo 'HTTP/[0-9\.]+\s+[0-9]{3}' file.txt`              |
| Find Base64 Encoded Strings                      | `grep -Eo '([A-Za-z0-9+/]{4}){2,}' file.txt`                |
| Search for Credit Card Numbers                   | `grep -Eo '\b[0-9]{13,16}\b' file.txt`                      |
| Detect SQL Injection Attempts                    | `grep -Ei 'union.*select\|select.*from\|drop\s+table' file.txt` |
| Search for JavaScript Functions                  | `grep -Eo 'function\s+[a-zA-Z0-9_]+\s*\(' file.txt`          |
| Extract Social Security Numbers                  | `grep -Eo '\b[0-9]{3}-[0-9]{2}-[0-9]{4}\b' file.txt`        |
| Find Passwords in Files                          | `grep -Eo 'password\s*[:=]\s*\S+' file.txt`                 |
| Identify Private Keys                            | `grep -Eo '-----BEGIN (RSA\|DSA\|EC) PRIVATE KEY-----.*-----END (RSA\|DSA\|EC) PRIVATE KEY-----' file.txt` |
| Extract Phone Numbers                            | `grep -Eo '\b[0-9]{3}-[0-9]{3}-[0-9]{4}\b' file.txt`        |
| Detect Shell Commands                            | `grep -Eo '(\bsh\b\|\bbash\b\|\bpython\b\|\bperl\b\|\bphp\b)' file.txt` |
| Search for Hidden Directories                    | `grep -Eo '\/\.[a-zA-Z0-9_-]+' file.txt`                    |
| Find JavaScript Variables                        | `grep -Eo 'var\s+[a-zA-Z0-9_]+\s*=' file.txt`               |



## Miscellaneous

| Description                                      | Command                                |
|--------------------------------------------------|----------------------------------------|
| Suppress Errors about Non-Existent or Unreadable Files | `grep -s pattern file.txt`            |
| Use Extended Regular Expressions                 | `grep -E pattern file.txt`             |
| Show the Byte Offset of Matches                  | `grep -b pattern file.txt`             |
| Match the Whole Word                             | `grep -w word file.txt`                |
| Match the Whole Line                             | `grep -x whole line file.txt`          |
| Use a Pattern File                               | `grep -f patterns.txt file.txt`        |
| Exclude a Pattern                                | `grep -v exclude_pattern file.txt`     |
| Include Binary Files in the Search               | `grep -a pattern binaryfile.bin`       |
| Search for Lines Starting with a Specific Pattern| `grep ^pattern file.txt`               |
| Search for Lines Ending with a Specific Pattern  | `grep pattern$ file.txt`               |
| Display Only the Matching Filename               | `grep -H pattern file.txt`             |
| Display the Total Number of Matches              | `grep -o pattern file.txt \| wc -l`    |
| Display Lines Containing Multiple Patterns       | `grep pattern1 file.txt \| grep pattern2` |
| Display a List of Files and Their Line Count with Matches | `grep -c pattern *.txt`        |
| Display Lines Matching a Pattern Ignoring Binary Files | `grep --binary-files=text pattern file.txt` |
| Include Line and Byte Offset in the Output       | `grep -b -n pattern file.txt`          |
| Search Using Perl-Compatible Regular Expressions | `grep -P pattern file.txt`             |
| Display Only Non-Matching Lines                  | `grep -L pattern file.txt`             |
| Exclude Specific Files from Search               | `grep --exclude=file.txt pattern /path/to/search` |
| Exclude Multiple Files from Search               | `grep --exclude={file1.txt,file2.txt} pattern /path/to/search` |
| Exclude Specific Directories from Search         | `grep --exclude-dir=dir pattern /path/to/search` |
| Include Only Specific Files in Search            | `grep --include=\*.{c,h} pattern /path/to/search` |
