#!/bin/bash

# Set NOTION_TOKEN and NOTION_DATABASE_ID
# Note: Assumes there is subdomains.txt 
# also assumes your Notion database has
# a Name property for the subdomain and a Date Added property

NOTION_TOKEN="your_notion_token"
NOTION_DATABASE_ID="your_database_id"

# Get the current date and time
current_date=$(date '+%Y-%m-%d %H:%M:%S')

# Loop through the txt file
while IFS= read -r subdomain
do
    # Prepare the data to be sent to Notion
    data=$(cat <<EOF
    {
        "parent": { "database_id": "$NOTION_DATABASE_ID" },
        "properties": {
            "Name": {
                "title": [
                    {
                        "text": {
                            "content": "$subdomain"
                        }
                    }
                ]
            },
            "Date Added": {
                "date": {
                    "start": "$current_date",
                    "end": null
                }
            }
        }
    }
EOF
)

    # Send the data to Notion
    curl -X POST https://api.notion.com/v1/pages \
      -H "Authorization: Bearer $NOTION_TOKEN" \
      -H "Content-Type: application/json" \
      -H "Notion-Version: 2022n-06-28" \
      --data "$data"
done < subdomains.txt
