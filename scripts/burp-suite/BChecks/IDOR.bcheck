metadata:
  language: v1-beta
  name: "IDOR-check"
  description: "Checks for potential IDOR vulnerabilities"
  author: "SecGPT"

run for each:
  potential_id = "999999"

given request then
  send request called check:
    method: {request.method}
    path: {request.path}
    parameters: {request.parameters.replace("PLACEHOLDER", potential_id)}
    body: {request.body}

  if {check.response.status_code} != 404 then
    report issue:
      name: "Potential IDOR vulnerability detected"
      severity: high
      confidence: certain
      description: "The application may be vulnerable to Insecure Direct Object References (IDOR). The ID `{potential_id}` was accessible."
      remediation: "Implement proper access controls to prevent unauthorized access to resources."
      evidence: {check.response.body}
						