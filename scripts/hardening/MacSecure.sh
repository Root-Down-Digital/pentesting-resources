#!/bin/bash

# MacSecure.sh - A script to harden the security of a MacOS system
# by disabling unnecessary services and protocols, enabling security features,
# and asking the user for confirmation before making any changes.

echo "Disable SMBv1?"
read -p "(Y/N) " input
if [[ $input =~ ^[Yy]$ ]]; then
  sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.smbd.plist
fi

echo "Disable Remote Registry Service?"
read -p "(Y/N) " input
if [[ $input =~ ^[Yy]$ ]]; then
  sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.RemoteManagement.plist
fi

echo "Disable LLMNR?"
read -p "(Y/N) " input
if [[ $input =~ ^[Yy]$ ]]; then
  sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist
fi

echo "Disable NetBIOS over TCP/IP?"
read -p "(Y/N) " input
if [[ $input =~ ^[Yy]$ ]]; then
  sudo sysctl -w net.inet.tcp.msl=1000
  sudo sysctl -w net.inet.udp.maxdgram=576
fi

echo "Enable Control Flow Guard (CFG)?"
read -p "(Y/N) " input
if [[ $input =~ ^[Yy]$ ]]; then
  sudo sysctl -w kern.cfg=1
fi

echo "Done!"

