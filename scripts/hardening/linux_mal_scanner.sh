#!/bin/bash

# Check if root
if [ $(id -u) -ne 0 ]; then
    echo "Script must be run as root"
    exit 1
fi

# Install required packages if not already installed
required_packages=(rkhunter clamav lynis chkrootkit)
for package in "${required_packages[@]}"; do
    if ! command -v "$package" &> /dev/null; then
        echo "$package not found, installing..."
        sudo apt install -y "$package"
    else
        echo "$package already installed"
    fi
done

# Run system scans and save output to a file
echo "Running system scans..."
sudo rkhunter --update
sudo rkhunter --check 
sudo clamscan -r / 
sudo lynis audit system 
sudo chkrootkit

echo "System scans completed."
