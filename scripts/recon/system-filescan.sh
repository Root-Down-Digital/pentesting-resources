#!/bin/bash

# Create a log file with the current date and time
LOG_FILE="recon_report_$(date +%Y-%m-%d_%H-%M-%S).txt"

# Find all SUID files and redirect stderr to /dev/null
echo "### SUID files ###" >> $LOG_FILE
find / -perm -u=s -type f -exec file {} \; 2>/dev/null >> $LOG_FILE
echo "" >> $LOG_FILE

# Find all world-writable files and redirect stderr to /dev/null
echo "### World-writable files ###" >> $LOG_FILE
find / -perm -o+w -type f 2>/dev/null >> $LOG_FILE
echo "" >> $LOG_FILE

# List all files in /etc/cron* and its subdirectories
echo "### Files in /etc/cron* ###" >> $LOG_FILE
ls -laR /etc/cron* >> $LOG_FILE
echo "" >> $LOG_FILE

# Show contents of /etc/issue
echo "### /etc/issue contents ###" >> $LOG_FILE
cat /etc/issue >> $LOG_FILE
echo "" >> $LOG_FILE

# Show output of uname -a command
echo "### OS and Kernel ###" >> $LOG_FILE
uname -a >> $LOG_FILE
echo "" >> $LOG_FILE

# Show installed packages
echo "### Installed packages ###" >> $LOG_FILE
dpkg -l >> $LOG_FILE
echo "" >> $LOG_FILE

# Show last logged-in users using last
echo "### last users output ###" >> $LOG_FILE
last >> $LOG_FILE
echo "" >> $LOG_FILE
