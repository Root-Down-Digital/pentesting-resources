# Define the directories to search
$searchDirs = @(
    "C:\",                             # Root of C: drive
    "\\",                              # Network shares (you might need to specify more specific network paths)
    "$env:USERPROFILE\Documents",      # User Documents
    "$env:USERPROFILE\Desktop",        # User Desktop
    "$env:USERPROFILE\AppData",        # User AppData
    "$env:ALLUSERSPROFILE",            # All Users Profile
    "C:\Windows",                      # Windows directory
    "C:\Program Files",                # Program Files
    "C:\Program Files (x86)",          # Program Files (x86)
    "C:\inetpub\wwwroot",              # Default IIS web root
    "C:\Scripts",                      # Custom Scripts directory
    "C:\Shares",                       # Custom Shares directory
    "$env:PUBLIC",                     # Public directory
    "C:\SharePoint"                    # SharePoint directory (if applicable)
)

# Define the specific files to search for
$specificFiles = @(
    "unattend.xml",
    "web.config",
    "pass.txt",
    "passwords.docx",
    "passwords.xlsx"
)

# Define the keywords to search for in files
$keywords = @(
    "password",
    "passwd",
    "credentials",
    "secret",
    "key",
    "token",
    "KeePass"
)

# Define the specific file patterns to search for
$filePatterns = @(
    "*.txt",
    "*.docx",
    "*.xlsx",
    "*.xml",
    "*.config",
    "*.ps1",
    "*.bat",
    "*.sh"
)

# Function to search for specific files
function Search-SpecificFiles {
    param (
        [string[]]$directories,
        [string[]]$files
    )
    foreach ($dir in $directories) {
        foreach ($file in $files) {
            Get-ChildItem -Path $dir -Filter $file -Recurse -ErrorAction SilentlyContinue | ForEach-Object {
                Write-Host "Found file: $($_.FullName)"
            }
        }
    }
}

# Function to search for specific keywords in files
function Search-Keywords {
    param (
        [string[]]$directories,
        [string[]]$keywords
    )
    foreach ($dir in $directories) {
        Get-ChildItem -Path $dir -Recurse -File -ErrorAction SilentlyContinue | ForEach-Object {
            $fileContent = Get-Content -Path $_.FullName -ErrorAction SilentlyContinue
            foreach ($keyword in $keywords) {
                if ($fileContent -match $keyword) {
                    Write-Host "Found keyword '$keyword' in file: $($_.FullName)"
                }
            }
        }
    }
}

# Function to search for specific file patterns
function Search-FilePatterns {
    param (
        [string[]]$directories,
        [string[]]$patterns
    )
    foreach ($dir in $directories) {
        foreach ($pattern in $patterns) {
            Get-ChildItem -Path $dir -Filter $pattern -Recurse -ErrorAction SilentlyContinue | ForEach-Object {
                Write-Host "Found file: $($_.FullName)"
            }
        }
    }
}

# Execute the search functions
Search-SpecificFiles -directories $searchDirs -files $specificFiles
Search-Keywords -directories $searchDirs -keywords $keywords
Search-FilePatterns -directories $searchDirs -patterns $filePatterns
